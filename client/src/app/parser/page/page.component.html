@if(pageNumber()) {
<div class="page-nav">
  <a
    mat-icon-button
    [routerLink]="[
      '/sources',
      selectedSourceId(),
      'page',
      (pageNumber() ?? 0) - 1
    ]"
    aria-label="Previous page"
    ><mat-icon>arrow_back_ios_new</mat-icon></a
  >
  <mat-form-field>
    <mat-label>Page</mat-label>
    <input
      matInput
      type="number"
      [(ngModel)]="pageNumber"
      (change)="onPageChange()"
    />
  </mat-form-field>
  <a
    mat-icon-button
    [routerLink]="[
      '/sources',
      selectedSourceId(),
      'page',
      (pageNumber() ?? 0) + 1
    ]"
    aria-label="Next page"
    ><mat-icon>arrow_forward_ios</mat-icon></a
  >
  @if (sourceType() === 'images') {
  <label class="add-image-button">
    <button mat-icon-button aria-label="Add image" type="button">
      <mat-icon>add_photo_alternate</mat-icon>
    </button>
    <input
      type="file"
      accept=".png,.jpg,.jpeg,.gif,.webp"
      (change)="onImageFileSelected($event)"
      class="hidden-file-input"
    />
  </label>
  }
</div>
} @if (pageLoading()) {
<mat-spinner class="page-loading" />
} @else if (isEmptyImageSource()) {
<div
  class="image-dropzone"
  [class.dragging]="isDragging()"
  (dragover)="onDragOver($event)"
  (dragleave)="onDragLeave($event)"
  (drop)="onDrop($event)"
>
  @if (uploading()) {
  <mat-spinner></mat-spinner>
  } @else {
  <mat-icon class="upload-icon">add_photo_alternate</mat-icon>
  <p class="dropzone-text">
    Drag and drop an image here or
    <label class="file-input-label">
      browse
      <input
        type="file"
        accept=".png,.jpg,.jpeg,.gif,.webp"
        (change)="onImageFileSelected($event)"
        class="hidden-file-input"
      />
    </label>
  </p>
  <p class="dropzone-hint">PNG, JPG, JPEG, GIF, WEBP</p>
  }
  @if (uploadError()) {
  <p class="error-message">{{ uploadError() }}</p>
  }
</div>
} @else {
<section
  class="page-layout"
  appDraggableSelection
  (selectionBox)="onSelection($event)"
  [style.height]="heightStyle"
  [attr.data-ready]="isReady()"
  [style.background-image]="documentImage.value() ? 'url(' + documentImage.value() + ')' : 'none'"
  [style.background-size]="'100% 100%'"
>
  @if (selectionRegionsLoading()) {
  <mat-spinner class="area-loading"></mat-spinner>
  } @for (span of spans(); track $index) {
  <app-span
    [sourceId]="selectedSourceId()"
    [pageNumber]="pageNumber()"
    [text]="span.text"
    [bbox]="span.bbox"
    [font]="span.font"
    [color]="span.color"
    [fontSize]="span.fontSize"
    [searchTerm]="span.searchTerm"
    [exists]="span.exists"
    [selectionRegions]="selectionRegions()"
  ></app-span>
  }
</section>

<app-bulk-card-creation-fab></app-bulk-card-creation-fab>
}
