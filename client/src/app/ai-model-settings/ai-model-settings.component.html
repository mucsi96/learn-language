<div class="ai-model-settings-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title><h2>AI Model Settings</h2></mat-card-title>
      <a
        mat-icon-button
        routerLink="/model-usage"
        matTooltip="View model usage logs"
        aria-label="View model usage logs"
      >
        <mat-icon>analytics</mat-icon>
      </a>
    </mat-card-header>
    <mat-card-content>
      <div class="table-wrapper">
        @if (settings.isLoading()) {
        <table class="matrix-table">
          <thead>
            <tr>
              <th class="operation-header"></th>
              @for (i of [1, 2, 3, 4, 5, 6]; track i) {
              <th class="model-header">
                <div class="skeleton skeleton-header"></div>
              </th>
              }
            </tr>
          </thead>
          <tbody>
            @for (j of [1, 2, 3, 4, 5]; track j) {
            <tr>
              <td class="operation-cell">
                <div class="skeleton skeleton-operation"></div>
              </td>
              @for (i of [1, 2, 3, 4, 5, 6]; track i) {
              <td class="toggle-cell">
                <div class="skeleton skeleton-toggle"></div>
              </td>
              }
            </tr>
            }
          </tbody>
        </table>
        } @else {
        <table class="matrix-table">
          <thead>
            <tr>
              <th class="operation-header">Operation</th>
              @for (modelName of modelNames(); track modelName) {
              <th class="model-header">
                <span class="model-header-text">{{ modelName }}</span>
              </th>
              }
            </tr>
          </thead>
          <tbody>
            @for (operation of settings.value(); track operation.operationType) {
            <tr>
              <td class="operation-cell">{{ operation.operationDisplayName }}</td>
              @for (modelName of modelNames(); track modelName) {
              <td class="toggle-cell">
                @let model = getModel(operation, modelName);
                <mat-slide-toggle
                  [checked]="model.isEnabled"
                  [disabled]="isToggling(operation.operationType, modelName)"
                  (change)="
                    onToggle(operation.operationType, modelName, $event.checked)
                  "
                  [attr.aria-label]="
                    (model.isEnabled ? 'Disable ' : 'Enable ') +
                    modelName +
                    ' for ' +
                    operation.operationDisplayName
                  "
                ></mat-slide-toggle>
              </td>
              }
            </tr>
            }
          </tbody>
        </table>
        }
      </div>
    </mat-card-content>
  </mat-card>
</div>
